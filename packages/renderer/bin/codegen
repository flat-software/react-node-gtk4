#!/bin/sh
set -e

# Go to the root of the project.
cd "$(dirname "$0")/.."

# Clean up the generated files.
rm -rf ./src/generated
rm -rf ./src/generated/__tests__
mkdir -p ./src/generated/widgets
mkdir -p ./src/generated/__tests__/widgets

# Generate the GIR types.
yarn girs:generate
rm -f ./src/generated/girs/*-import.js

# Generate the types.
node ../codegen/dist/index.js .

# Format the generated files.
yarn prettier --write ./src/generated/**/*.{ts,tsx,js} --ignore-path .prettierignore
yarn prettier --write ./src/generated/__tests__/**/*.{ts,tsx,js} --ignore-path .prettierignore
